@using ExpenseProcessingSystem.ViewModels
@using ExpenseProcessingSystem.ConstantData
@using System.Xml.Linq
@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor HttpContextAccessor
@model LiquidationViewModel
@inject IJsonHelper Json;

@{
    ViewData["Title"] = "Liquidation_SS";
}

<input id="_screen" type="hidden" value="liq_Dtl" />
@using (Html.BeginForm("Liquidation_AddNewSS", "Home", FormMethod.Post))
{
    <div class="tabContent">

        <div id="tbl-lbl">
            <div class="dis-inline-block"><p>Expense Entry Registered Date:</p></div>
            <div class="dis-inline-block">
                <input id="expenseDate" value="@(((DateTime)Model.expenseDate).ToString("MM/dd/yyyy"))" style="background-color:transparent" />
            </div>
            <div class="dis-inline-block" style="float:right">
                <p class="dis-inline-block">
                    @Html.TextBoxFor(model => model.expenseYear, new { @readonly = "true", @class = "input" })
                </p>
                -
                <p class="dis-inline-block">
                    @Html.TextBoxFor(model => model.expenseId, new { @readonly = "true", @class = "input" })
                </p>
            </div>
        </div>
        <div class="flex-c">
            <table class="table table-bordered table-striped voucher-tbl w-97 table-hover" id="inputTable">
                <colgroup>
                    <col style="width:4%;" />
                    <col style="width:13%;" />
                    <col style="width:13%;" />
                    <col style="width:15%;" />
                    <col style="width:10%" />
                    <col style="width:2%;" />
                    <col style="width:5%;" />
                    <col style="width:2%;" />
                    <col style="width:5%;" />
                    <col style="width:2%;" />
                    <col style="width:5%;" />
                    <col style="width:8%;" />
                    <col style="width:8%;" />
                    <col style="width:8%;" />
                    <col style="width:2%;" />
                </colgroup>
                <thead>
                    <tr>
                        <th rowspan="2"></th>
                        <th rowspan="2">Gbase Remarks</th>
                        <th rowspan="2">Payee</th>
                        <th rowspan="2">Account</th>
                        <th rowspan="2">Department</th>
                        <th colspan="2" rowspan="2">VAT</th>
                        <th colspan="3" rowspan="2">EWT</th>
                        <th rowspan="2">Currency</th>
                        <th>Debit</th>
                        <th colspan="2">Credit</th>
                    </tr>
                    <tr>
                        <th scope="col">Gross Amount</th>
                        <th scope="col">EWT Amount</th>
                        <th scope="col">Cash</th>
                    </tr>
                </thead>
                <tbody>
                    @for (int i = 0; i < Model.LiquidationDetails.Count; i++)
                    {
                        <tr id="item_@i">
                            <td id="sss">
                                <a class="liqudationBtn" href="#"><img id="imgLiq" src="~/images/liqLogo.png"/></a>
                                @Html.HiddenFor(x => Model.LiquidationDetails[i].EntryDetailsID, new { @class = "entryDtlID" })
                                @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInputFlag, new { @class = "hiddenLiqFlag" })
                                <div id="divLiqCashBD_@i">
                                    @for (int y = 0; y < Model.LiquidationDetails[i].liqCashBreakdown.Count(); y++)
                                    {
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqCashBreakdown[y].cashDenomination)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqCashBreakdown[y].cashNoPC)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqCashBreakdown[y].cashAmount)
                                    }
                                </div>
                                <div id="divLiqIE_@i">
                                    @for (int y = 0; y < Model.LiquidationDetails[i].liqInterEntity.Count(); y++)
                                    {
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_AccountID_1_1)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_AccountID_1_2)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_AccountID_2_1)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_AccountID_2_2)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_AccountID_3_1)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_AccountID_3_2)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_Amount_1_1)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_Amount_1_2)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_Amount_2_1)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_Amount_2_2)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_Amount_3_1)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_Amount_3_2)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_CCY_1_1)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_CCY_1_2)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_CCY_2_1)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_CCY_2_2)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_CCY_3_1)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_CCY_3_2)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_DebitCred_1_1)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_DebitCred_1_2)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_DebitCred_2_1)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_DebitCred_2_2)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_DebitCred_3_1)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_DebitCred_3_2)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_InterRate_1_1)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_InterRate_1_2)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_InterRate_2_1)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_InterRate_2_2)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_InterRate_3_1)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_InterRate_3_2)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_Tax_Rate)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].liqInterEntity[y].Liq_VendorID)
                                    }
                                </div>
                            </td>
                            <td class="p-b-1 p-t-1">
                                <div class="flex-sb">
                                    @Html.TextBoxFor(x => Model.LiquidationDetails[i].GBaseRemarks, new { @class = "txtGBaseRemark", @readonly = "true", @style = "width:100%;background:transparent" })
                                    <div id="remark_@i">
                                        <a href="#" class="gRemarks glyphicon glyphicon-folder-open fs-15 m-r-5"></a>
                                        @for (int y = 0; y < Model.LiquidationDetails[i].gBaseRemarksDetails.Count(); y++)
                                        {
                                            @Html.HiddenFor(x => Model.LiquidationDetails[i].gBaseRemarksDetails[y].docType);
                                            @Html.HiddenFor(x => Model.LiquidationDetails[i].gBaseRemarksDetails[y].desc);
                                            @Html.HiddenFor(x => Model.LiquidationDetails[i].gBaseRemarksDetails[y].invNo);
                                            @Html.HiddenFor(x => Model.LiquidationDetails[i].gBaseRemarksDetails[y].amount);
                                        }
                                    </div>
                                </div>
                            </td>
                            <td>
                                @Html.TextBoxFor(m => Model.LiquidationDetails[i].dtlSSPayeeName, new { @class = "txtPayee", @readonly = "true", @style = "width:100%;background:transparent" })
                            </td>
                            <td>
                                @Html.TextBoxFor(m => Model.LiquidationDetails[i].accountName, new { @class = "txtAcc", @readonly = "true", @style = "width:100%;background:transparent" })
                                @Html.HiddenFor(m => Model.LiquidationDetails[i].accountID, new { @class = "hidAccID" })
                                @Html.HiddenFor(m => Model.LiquidationDetails[i].accountNumber, new { @class = "hidAccNo" })
                                @Html.HiddenFor(m => Model.LiquidationDetails[i].accountCode, new { @class = "hidAccCode" })
                            </td>
                            <td>
                                @Html.TextBoxFor(m => Model.LiquidationDetails[i].deptName, new { @readonly = "true", @style = "width:100%;background:transparent" })
                            </td>
                            <td style="text-align:center;">
                                @Html.CheckBoxFor(x => Model.LiquidationDetails[i].chkVat, new { @class = "chkVat comVar", disabled = "disabled" })
                            </td>
                            <td>
                                @Html.TextBoxFor(m => Model.LiquidationDetails[i].vatValue, new { @readonly = "true", @style = "width:100%;background:transparent" })
                            </td>
                            <td style="text-align:center">
                                @Html.CheckBoxFor(x => Model.LiquidationDetails[i].chkEwt, new { @class = "chkEwt comVar", disabled = "disabled" })
                            </td>
                            <td>
                                @Html.TextBoxFor(m => Model.LiquidationDetails[i].ewtValue, new { @readonly = "true", @style = "width:100%;background:transparent" })
                                @Html.HiddenFor(m => Model.LiquidationDetails[i].ewtID, new { @class = "ewtID" })
                            </td>
                            <td style="text-align:center">
                                <a class="reqEWTBtn glyphicon glyphicon-list-alt expenseEWT" href="#" style="pointer-events:none;"></a>
                                @Html.HiddenFor(x => Model.LiquidationDetails[i].dtl_Ewt_Payor_Name_ID, new { @class = "txtPayor" })
                            </td>
                            <td>
                                @Html.HiddenFor(m => Model.LiquidationDetails[i].ccyID, new { @class = "currID" })
                                @Html.HiddenFor(m => Model.LiquidationDetails[i].ccyMasterID, new { @class = "currMasterID" })
                                @Html.TextBoxFor(m => Model.LiquidationDetails[i].ccyAbbrev, new { @class = "txtCcyAbbrev", @readonly = "true", @style = "width:100%;background:transparent" })
                            </td>
                            <td>
                                @Html.TextBoxFor(m => Model.LiquidationDetails[i].debitGross, new { @class = "txtGross", @readonly = "true", @style = "width:100%;background:transparent" })
                            </td>
                            <td>
                                @Html.TextBoxFor(m => Model.LiquidationDetails[i].credEwt, new { @readonly = "true", @style = "width:100%;background:transparent" })
                            </td>
                            <td>
                                @Html.TextBoxFor(m => Model.LiquidationDetails[i].credCash, new { @class = "txtCredit txtCredCash", @readonly = "true", @style = "width:100%;background:transparent" })
                            </td>
                            <td id="req_@i">
                                <a class="cashBreakdown reqBtn glyphicon glyphicon-list-alt" href="#"></a>
                                @if (Model.LiquidationDetails[i].ccyMasterID != int.Parse(XElement.Load("wwwroot/xml/LiquidationValue.xml").Element("CURRENCY_PHP").Value))
                                {
                                    <a class="cddISBtn" href="#"><img id="imgCDD" src="~/images/cddLogo.png" style="height:100%" /></a>
                                }
                                @Html.HiddenFor(x => Model.LiquidationDetails[i].modalInputFlag, new { @class = "hiddenItem" })
                                @Html.HiddenFor(x => Model.LiquidationDetails[i].screenCode, new { @class = "hiddenScreencode" })
                                <div id="divCashBD_@i">
                                    @for (int y = 0; y < Model.LiquidationDetails[i].cashBreakdown.Count(); y++)
                                    {
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].cashBreakdown[y].cashDenomination)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].cashBreakdown[y].cashNoPC)
                                        @Html.HiddenFor(x => Model.LiquidationDetails[i].cashBreakdown[y].cashAmount)
                                    }
                                </div>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
        @*+++++++++++Liquidation form+++++++++++*@
        <div style="width:100%;text-align:center;padding-top:0.5%" class="table-bordered">
            <input type="hidden" id="hiddenSelectedItem" />
            @*+++++++++++Liquidation form for PHP currency+++++++++++*@
            <div id="divPHP" style="display:none;text-align:center">
                <div style="display:inline-block;width:100%">
                    <label>Liquidation for PHP currency</label>
                </div>
                <div style="display:inline-block;text-align:center;width:55%;vertical-align:top">
                    <table style="width:100%;" class="tableLiqPhp table-bordered table-striped voucher-tbl">
                        <colgroup>
                            <col style="width:40%" />
                            <col style="width:10%" />
                            <col style="width:15%" />
                            <col style="width:17.5%" />
                            <col style="width:17.5%" />
                        </colgroup>
                        <tr>
                            <td colspan="5" style="text-align:left">
                                <label style="width:auto">Tax Payor's Name: </label>
                                <label style="width:80%">@Html.DropDownListFor(x => Model.vendorList, new SelectList(Model.vendorList, "Vendor_ID", "Vendor_Name"), new { @id = "txtLiqVendor", @class = "input100 selectDisabled ", @style = "width:auto;text-align:center", @disabled = "disabled" })</label>
                            </td>
                        </tr>
                        <tr>
                            <th style="text-align:center"><label>ACCOUNT NO.</label></th>
                            <th style="text-align:center"><label>ACCONT CODE</label></th>
                            <th style="text-align:center"><label>EWT(%)</label></th>
                            <th style="text-align:center"><label>DEBIT</label></th>
                            <th style="text-align:center"><label>CREDIT</label></th>
                        </tr>
                        <tr>
                            <td>
                                @Html.DropDownListFor(x => Model.acc, new SelectList(Model.accList, "Account_ID", "Account_Name"), new { @id = "ddlLiqPhpAccount1", @style = "width:100%", @class = "input100 selectDisabled ddlLiqPhp ddlLiqPhpAccount" })
                            </td>
                            <td>
                                <input id="txtLiqAccCode1" class="input100" readonly="readonly" style="width:100%;background:transparent;text-align:center" type="text" value="">
                            </td>
                            <td></td>
                            <td>
                                <input id="txtLiqPhpInput1" class="input100 txtLiqPhpInput number-input" style="width:100%;text-align:center" type="text" value="0" />
                            </td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>
                                <select id="ddlLiqPhpAccount2" style="width:100%" class="input100 selectDisabled ddlLiqPhp ddlLiqPhpAccount"></select>
                            </td>
                            <td>
                                <input id="txtLiqAccCode2" class="input100" readonly="readonly" style="width:100%;background:transparent;text-align:center" type="text" value="">
                            </td>
                            <td></td>
                            <td>
                                <input id="txtLiqPhpInput2" class="input100 LiqPhpBDOPettyInput txtLiqPhpInput number-input" style="width:100%;text-align:center" type="text" value="0" />
                            </td>
                            <td>
                                <input id="txtLiqPhpInput3" class="input100 LiqPhpBDOPettyInput txtLiqPhpInput number-input" style="width:100%;text-align:center" type="text" value="0" />
                            </td>
                        </tr>
                        <tr>
                            <td style="text-align:left;">
                                @Html.DropDownListFor(x => Model.accAllList, new SelectList(Model.accAllList, "Account_ID", "Account_Name", null, "Account_MasterID"), new { @id = "lblAccount1_PHP", @style = "width:100%", @class = "input100 selectDisabled", @disabled = "disabled" })
                            </td>
                            <td>
                                <input id="txtLiqAccCode3" class="input100" readonly="readonly" style="width:100%;background:transparent;text-align:center" type="text" value="">
                            </td>
                            <td>
                                @*@Html.DropDownListFor(x => Model.taxRateList, new SelectList(Model.taxRateList, "TR_ID", "TR_WT_Title"), new { @id = "txtLiqTaxRate", @style = "width:100%;text-align:center", @class = "input100 ddlLiqPhp" })*@
                                <select id="txtLiqTaxRate" style="width:100%;text-align:center" class="input100 ddlLiqPhp"></select>
                            </td>
                            <td></td>
                            <td>
                                <input id="txtLiqPhpInput4" class="input100 txtLiqPhpInput number-input" style="width:100%;text-align:center" type="text" value="0" />
                            </td>
                        </tr>
                        <tr>
                            <td style="text-align:left;">
                                @Html.DropDownListFor(x => Model.acc, new SelectList(Model.accAllList, "Account_ID", "Account_Name", null, "Account_MasterID"), new { @id = "lblAccount2_PHP", @style = "width:100%", @class = "input100 selectDisabled", @disabled = "disabled" })
                            <td>
                                <input id="txtLiqAccCode4" class="input100" readonly="readonly" style="width:100%;background:transparent;text-align:center" type="text" value="">
                            </td>
                            <td></td>
                            <td></td>
                            <td>
                                <input id="txtLiqPhpInput5" class="input100" readonly="readonly" style="width:100%;text-align:center" type="text" value="0" />
                            </td>
                        </tr>
                        <tr>
                            <td colspan="3" style="text-align:right;">
                                <label>Total:</label>
                            </td>
                            <td>
                                <input id="txtLiqPhpInput6" class="input100" style="width:100%;text-align:center" readonly="readonly" type="text" value="0" />
                            </td>
                            <td>
                                <input id="txtLiqPhpInput7" class="input100" style="width:100%;text-align:center" readonly="readonly" type="text" value="0" />
                            </td>
                        </tr>
                    </table>
                    <table style="width:100%;margin-top:5%">
                        <tr>
                            <td colspan="2" style="text-align:left">
                                <label>Transaction No.: </label><input type="text" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <input type="button" id="saveLiqPhp" class="saveLiqPhpBtn btn" value="Save Liquidation" />
                            </td>
                            <td>
                                <input type="button" class="printCashBDBtn btn" value="Print Cash Breakdown" onclick='printDivCashLiqBD("divCashBDLiq");' />
                            </td>
                        </tr>
                    </table>
                </div>
                <div id="divCashBDLiq" style="display:inline-block;text-align:center;width:35%">
                    <table style="width:100%;" id="tableTitlePrint" border="0" class="tblHidePrintLiq">
                        <tr>
                            <td style="text-align:left"><img src="~/images/mizuho-logo.png" style="width:50%;height:30%" /></td>
                            <td style="text-align:right">PETTY CASH BREAKDOWN</td>
                        </tr>
                        <tr style="border-top:solid">
                            <td style="text-align:left"></td>
                            <td style="text-align:right">Mizuho Bank, Ltd - Manila Branch</td>
                        </tr>
                    </table>
                    <table style="width:60%;" id="tableHeaderPrint" border="0" class="tblHidePrintLiq">
                        <tr>
                            <td style="width:5%;text-align:left">Date : </td>
                            <td><input id="cashbdDatePrintLiq" style="text-align:center" /></td>
                        </tr>
                        <tr>
                            <td style="width:5%;text-align:left">Amount: </td>
                            <td><input id="cashbdAmountPrintLiq" style="text-align:center" /></td>
                        </tr>
                    </table>
                    <table id="cashBDLiqTable" class="cashBDLiqTable table-bordered table-striped voucher-tbl w-70 tablePrintLiq">
                        <thead>
                            <tr>
                                <th style="text-align:center" class="thPrint"><label>Denomination</label></th>
                                <th style="text-align:center" class="thPrint"><label>No. of Pcs.</label></th>
                                <th style="text-align:center" class="thPrint"><label>Amount</label></th>
                            </tr>
                        </thead>
                        <tbody>
                            @{
                                int cnt = 0;
                                foreach (var i in DenominationValues.GetDenominationList())
                                {

                                    <tr id="cashbdliqid_@cnt">
                                        <td class="tdPrintLiq">
                                            <input type="number" class="txtLiqDenomination" readonly="readonly" style="width:100%;background:transparent;text-align:center" value="@i.CashBreak_Denomination" />

                                        </td>
                                        <td class="tdPrintLiq">
                                            <input type="number" class="txtLiqNoPCS number-inputNoDecNoBlank txtLiqPhpInput" style="width:100%;text-align:center" min="0" value="0" />

                                        </td>
                                        <td class="tdPrintLiq">
                                            <input type="number" class="txtLiqAmount" readonly="readonly" style="width:100%;background:transparent;text-align:center" value="0" />
                                        </td>
                                    </tr>
                                    cnt = cnt + 1;
                                }
                                <tr>
                                    <td colspan="2" style="text-align:right;" class="tdPrintLiq">
                                        <label>Total: </label>
                                    </td>
                                    <td class="tdPrintLiq">
                                        <label style="width:100%;">
                                            <input type="text" id="txtCashBDTotal" class="txtCashBDTotal" readonly="readonly" style="width:100%;background:transparent;text-align:center" value="0" />
                                        </label>
                                    </td>
                                </tr>
                            }
                        </tbody>
                    </table>
                    <table style="width:60%;" id="tableOptionPrint" border="0" class="tblHidePrintLiq">
                        <tr>
                            <td style="width:5%;text-align:left">EXPENSE</td>
                            <td style="text-align:center"><label style="font-size:x-large;text-align:center" value="&#9645;" id="printOptExpense"></label></td>
                        </tr>
                        <tr>
                            <td style="width:5%;text-align:left">REVERSAL</td>
                            <td style="text-align:center"><label style="font-size:x-large;text-align:center" value="&#9645;" id="printOptReverse"></label></td>
                        </tr>
                    </table>
                    <table style="width:60%;" id="tableSignPrint" border="1" class="tblHidePrintLiq">
                        <colgroup>
                            <col style="width:20%" />
                            <col style="width:10%" />
                            <col style="width:30%" />
                        </colgroup>
                        <tr>
                            <td colspan="2">PAYMENT RECEIVED BY :</td>
                            <td style="text-align:center"></td>
                        </tr>
                        <tr>
                            <td colspan="2">PAYMENT PAID BY :</td>
                            <td style="text-align:center"></td>
                        </tr>
                        <tr>
                            <td>PAYMENT FOR :</td>
                            <td colspan="2" style="text-align:center"><input id="paymentFor" /></td>
                        </tr>
                    </table>
                </div>
            </div>
            @*+++++++++++Liquidation form for FOREIGN currency+++++++++++*@
            <div id="divForeign" style="display:none;">
                <div style="display:inline-block;width:100%">
                    <label>INTER-ENTITY (Liquidation for Foreign currency)</label>
                </div>
                <div style="display:inline-block;text-align:center;width:auto;vertical-align:top">
                    <table id="IEInfoTable" class="table-bordered table-striped voucher-tbl">
                        <tr>
                            <td colspan="2">
                                <label>Cash Advance Amount:</label>
                            </td>
                            <td>
                                <input id="txtIECurrency" class="input100" readonly="readonly" style="width:100%;background:transparent;text-align:center" type="text" value="CCY" />
                            </td>
                            <td>
                                <input id="txtIEAmount" class="txtIEInfoInput input100 number-inputExceptionJPY" style="width:100%;text-align:center" type="text" value="0" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <label>Exchange Rate:</label>
                            </td>
                            <td>
                                <input id="txtIEExRate" class="txtIEInfoInput input100 number-input" style="width:100%;text-align:center" type="text" value="0" />
                            </td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td>
                                <label>Exchange Rate:</label>
                            </td>
                            <td>
                                <label>PHP</label>
                            </td>
                            <td colspan="2">
                                <input id="txtIEExRatePhp" class="txtIEExRatePhp input100" readonly="readonly" style="width:100%;background:transparent;text-align:center" />
                            </td>
                        </tr>
                    </table>
                    <table style="width:100%;margin-top:5%">
                        <tr>
                            <td colspan="2" style="text-align:left">
                                <label>Transaction No.: </label><input type="text" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <input type="button" id="saveLiqIE" class="saveIEBtn btn" value="Save Liqudation" />
                            </td>
                            <td></td>
                        </tr>
                    </table>
                </div>
                <div id="divIE" style="display:inline-block;text-align:center;width:60%">
                    <table id="IEInputTable" class="table-bordered table-striped voucher-tbl">
                        <colgroup>
                            <col style="width:25%" />
                            <col style="width:25%" />
                            <col style="width:5%" />
                            <col style="width:5%" />
                            <col style="width:10%" />
                            <col style="width:5%" />
                            <col style="width:10%" />
                        </colgroup>
                        <thead>
                            <tr>
                                <td>Particular</td>
                                <td>Account</td>
                                <td>INTER-RATE</td>
                                <td>CCY</td>
                                <td>DEBIT</td>
                                <td>CCY</td>
                                <td>CREDIT</td>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td rowspan="2"><label class="lblParticular"></label></td>
                                <td style="text-align:left">@Html.DropDownListFor(x => Model.acc, new SelectList(Model.accAllList, "Account_ID", "Account_Name", null, "Account_MasterID"), new { @id = "lblAccount1", @style = "width:100%", @class = "selectDisabled", @disabled = "disabled" })</td>
                                <td></td>
                                <td><label class="lblCurrency"></label></td>
                                <td><label class="lblIEInput" id="lblIEInput1"></label></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td style="text-align:left">@Html.DropDownListFor(x => Model.acc, new SelectList(Model.accAllList, "Account_ID", "Account_Name", null, "Account_MasterID"), new { @id = "lblAccount2", @style = "width:100%", @class = "selectDisabled", @disabled = "disabled" })</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td><label class="lblCurrency"></label></td>
                                <td><input id="txtIEInput1" class="txtIEInput number-inputExceptionJPY" style="width:100%;text-align:center" type="text" value="0" /></td>
                            </tr>
                            <tr>
                                <td><label></label></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td rowspan="3"><label class="lblParticular"></label></td>
                                <td style="text-align:left">
                                    @Html.DropDownListFor(x => Model.acc, new SelectList(Model.accList, "Account_ID", "Account_Name"), new { @id = "ddlAccount3", @style = "width:100%", @class = "selectDisabled" })
                                </td>
                                <td></td>
                                <td><label>PHP</label></td>
                                <td><input id="txtIEInput2" class="txtIEInput number-input" style="width:100%;text-align:center" type="text" value="0" /></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td style="text-align:left">
                                    <select id="ddlAccount11" style="width:100%" class="selectDisabled"></select>
                                </td>
                                <td></td>
                                <td>PHP</td>
                                <td><input id="txtIEInput3" class="txtIEInput number-input IEBDOPettyInput" style="width:100%;text-align:center" type="text" value="0" /></td>
                                <td><label>PHP</label></td>
                                <td><input id="txtIEInput4" class="txtIEInput number-input IEBDOPettyInput" style="width:100%;text-align:center" type="text" value="0" /></td>
                            </tr>
                            <tr>
                                <td style="text-align:left">@Html.DropDownListFor(x => Model.acc, new SelectList(Model.accAllList, "Account_ID", "Account_Name", null, "Account_MasterID"), new { @id = "lblAccount3", @style = "width:100%", @class = "selectDisabled", @disabled = "disabled" })</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td><label>PHP</label></td>
                                <td><label class="lblIEInput" id="lblIEInput2"></label></td>
                            </tr>
                            <tr>
                                <td><label></label></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td rowspan="2"><label class="lblParticular"></label></td>
                                <td style="text-align:left">@Html.DropDownListFor(x => Model.acc, new SelectList(Model.accAllList, "Account_ID", "Account_Name", null, "Account_MasterID"), new { @id = "lblAccount4", @style = "width:100%", @class = "selectDisabled", @disabled = "disabled" })</td>
                                <td></td>
                                <td><label>PHP</label></td>
                                <td><label class="lblIEInput" id="lblIEInput3"></label></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td style="text-align:left">@Html.DropDownListFor(x => Model.acc, new SelectList(Model.accAllList, "Account_ID", "Account_Name", null, "Account_MasterID"), new { @id = "lblAccount5", @style = "width:100%", @class = "selectDisabled", @disabled = "disabled" })</td>
                                <td><label class="lblIEInput" id="lblIEInput9"></label></td>
                                <td></td>
                                <td></td>
                                <td><label class="lblCurrency"></label></td>
                                <td><label class="lblIEInput" id="lblIEInput4"></label></td>
                            </tr>
                            <tr>
                                <td><label></label></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td rowspan="2"><label class="lblParticular"></label></td>
                                <td style="text-align:left">@Html.DropDownListFor(x => Model.acc, new SelectList(Model.accAllList, "Account_ID", "Account_Name", null, "Account_MasterID"), new { @id = "lblAccount6", @style = "width:100%", @class = "selectDisabled", @disabled = "disabled" })</td>
                                <td></td>
                                <td><label class="lblCurrency"></label></td>
                                <td><label class="lblIEInput" id="lblIEInput5"></label></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td style="text-align:left">@Html.DropDownListFor(x => Model.acc, new SelectList(Model.accAllList, "Account_ID", "Account_Name", null, "Account_MasterID"), new { @id = "lblAccount7", @style = "width:100%", @class = "selectDisabled", @disabled = "disabled" })</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td><label class="lblCurrency"></label></td>
                                <td><label class="lblIEInput" id="lblIEInput6"></label></td>
                            </tr>
                            <tr>
                                <td><label></label></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td colspan="7" style="text-align:left">CDD INSTRUCTION SHEET</td>
                            </tr>
                            <tr>
                                <td></td>
                                <td style="text-align:left">@Html.DropDownListFor(x => Model.acc, new SelectList(Model.accAllList, "Account_ID", "Account_Name", null, "Account_MasterID"), new { @id = "lblAccount8", @style = "width:100%", @class = "selectDisabled", @disabled = "disabled" })</td>
                                <td></td>
                                <td><label class="lblCurrency"></label></td>
                                <td><label class="lblIEInput" id="lblIEInput7"></label></td>
                                <td></td>
                                <td></td>
                            </tr>
                            <tr>
                                <td></td>
                                <td style="text-align:left">@Html.DropDownListFor(x => Model.acc, new SelectList(Model.accAllList, "Account_ID", "Account_Name", null, "Account_MasterID"), new { @id = "lblAccount9", @style = "width:100%", @class = "selectDisabled", @disabled = "disabled" })</td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td><label class="lblCurrency"></label></td>
                                <td><label class="lblIEInput" id="lblIEInput8"></label></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div id="entry-status" class="m-t-10 m-b-10">
            <div class="dis-inline-block"><label>Status: </label></div>
            <div class="dis-inline-block">@Html.TextBoxFor(x => x.status, new { @disabled = "disabled", @class = "input" })</div>
            <div class="dis-inline-block"><label>Approver:</label></div>
            <div class="dis-inline-block">@Html.TextBoxFor(x => x.approver, new { @disabled = "disabled", @class = "input" })</div>
            <div class="dis-inline-block"><label>Verifier:</label></div>
            <div class="dis-inline-block">
                <p class="dis-inline-block">@Html.TextBoxFor(x => x.verifier_1, new { @disabled = "disabled", @class = "m-l-5 input" })</p>
                <p class="dis-inline-block">@Html.TextBoxFor(x => x.verifier_2, new { @disabled = "disabled", @class = "m-l-5 input" })</p>
            </div>
        </div>
        <div id="entry-controls" class="m-b-10">
            @Html.HiddenFor(x => Model.entryID, new { @class = "entryID" })
            @Html.HiddenFor(x => Model.LiqEntryDetails.Liq_Created_Date, new { @class = "LiqEntryDetails_Liq_Created_Date" })
            @*<input type="hidden" id="LiqEntryDetails_Liq_Created_Date" value="@(((DateTime)Model.LiqEntryDetails.Liq_Created_Date).ToString("MM/dd/yyyy"))" style="background-color:transparent" />*@
            <div class="flex-sb">
                <div>
                    <div class="dis-inline-block tbl-btn"><button class="btnEntryAction" name="command" value="Save">Save</button></div>
                    <div class="dis-inline-block tbl-btn"><button disabled>Delete</button></div>
                    <div class="dis-inline-block tbl-btn"><button disabled>Modify</button></div>
                </div>
                <div>
                    <div class="dis-inline-block tbl-btn"><button id="reversal_entry" disabled>Create Reversal Entry</button></div>
                </div>
            </div>
            <div class="flex-sb">
                <div>
                    <div class="dis-inline-block tbl-btn"><button disabled>Approve/Verify</button></div>
                    <div class="dis-inline-block tbl-btn"><button disabled>Reject</button></div>
                </div>
                <div>
                    <div></div>
                </div>
                <div>
                    @if (int.Parse(HttpContextAccessor.HttpContext.Session.GetString("UserID")) == Model.maker
                   || int.Parse(HttpContextAccessor.HttpContext.Session.GetString("UserID")) == Model.verifier_1_id
                   || int.Parse(HttpContextAccessor.HttpContext.Session.GetString("UserID")) == Model.verifier_2_id
                   || int.Parse(HttpContextAccessor.HttpContext.Session.GetString("UserID")) == Model.approver_id)
                    {
                        <div class="dis-inline-block tbl-btn"><button id="printBir" value="printBir">Print BIR Certificate</button></div>
                    }
                </div>
            </div>
        </div>
        <div id="modalDiv">
            @Html.Partial("ModalGBase")
        </div>
        @Html.Partial("ModalPartial2")
    </div>
    <input type="hidden" id="phpID" value="@Model.phpCurrID" />
    <input type="hidden" id="phpAbbrv" value="@Model.phpAbbrev" />
    <input type="hidden" id="phpMasterID" value="@Model.phpCurrMasterID" />
    <input type="hidden" name="command" id="btnID" />
}
@*validation message*@
<div id="ValidationSummary" style="display:none" class="">
    @Html.ValidationSummary(false, "", new { @id = "validationSummary" })
</div>

@Html.Partial("PopupMessage")

<script type="text/javascript" src="~/js/LiquidationScript.js"></script>
<script>
    $(document).ready(function () {
        $('#liqudation').find('a').addClass('selected');

        //Enable Cash breakdown button if currency = PHP, disable if not.
        var trs = $("#inputTable").find("tbody").find("tr");
        for (var cnt = 0; cnt < trs.length; cnt++) {
            reqBtnDisable(cnt);
            if ($('#divLiqCashBD_' + cnt).find("input").length != 0 || $('#divLiqIE_' + cnt).find("input").length != 0) {
                $('#item_' + cnt).find('#imgLiq').attr('src', '/images/liqLogo_chk.png');
            }
        }

        //Cash Breakdown Modal
        $("table").on("click", ".cashBreakdown", function (e) {
            e.stopImmediatePropagation();

            var pNode = $(this.parentNode)[0].parentNode;
            var id = pNode.id;
            var modalDivBody = $('.modal-body');

            $('.modal-header').find('.modal-title').remove();
            $('.modal-header').append('<h4 class="modal-title">Cash Breakdown</h4>');

            modalDivBody.load("@Url.Action("EntryExpenseCashBreakdown", "Modal")", {
                "id": id,
                "vendor": $("#" + pNode.id).find(".txtPayee").val(),
                "account": $("#" + pNode.id).find(".txtAcc").val(),
                "amount": $("#" + pNode.id).find(".txtCredCash").val(),
                "screencode": $("#" + pNode.id).find(".hiddenScreencode").val()
            }, function (response, status, xhr) {
                if (status == "error") {
                    alert("Something went wrong.");
                } else {
                    if ($("#parentIdCashBreakdown") != null) {
                        var tableRef = document.getElementById('modalTable').getElementsByTagName('tbody')[0];
                        var grossAmount = Number($("#" + id).find(".txtGross").val());
                    }
                }
            });

            $('#myModal').modal('show');
        });

        //Liquidation DIV display/Hide
        $("table").on("click", ".liqudationBtn", function (e) {
            e.stopImmediatePropagation();
            var pid = $(this.parentNode)[0].parentNode.id;
            var idx = pid.replace('item_', '');

            //Change color of clicked row
            $("table tr").removeClass("highlight");
            $('#' + pid).addClass("highlight");

            $('#hiddenSelectedItem').val(pid);

            //Change to default value
            $('#divPHP').find('input:text').val('');
            $('#cashBDLiqTable').find('.txtLiqNoPCS').val(0);
            $('#cashBDLiqTable').find('.txtLiqAmount').val(0);
            $('#cashBDLiqTable').find('#txtCashBDTotal').val(0);
            $('#ddlLiqPhpAccount1').val($("#ddlLiqPhpAccount1 option:first").val());
            $('#txtIEExRatePhp').text("");

            $('#divForeign').find(':input[type="number"]').val(0);
            $('#ddlAccount3').val($("#ddlAccount3 option:first").val());

            if ($('#' + pid).find('.currMasterID').val() == getXMLLiqValue("CURRENCY_PHP")) {
                $('#divForeign').hide();
                $('#divPHP').show();
                $('#txtLiqVendor').val($('#' + pid).find('.txtPayor').val());
                $('#txtLiqPhpInput5').val($('#' + pid).find('.txtGross').val());
                $('#lblAccount2_PHP').val($('#' + pid).find('.hidAccID').val());

                displayInfoCashBD($(this.parentNode)[0].parentNode.id);
                assignAccCodeLiqPhp();
                HideCashBreakdownTable();
                ChangeOptionMarkForPrint();
            } else {
                $('#divForeign').show();
                $('#divPHP').hide();
                displayInfoIE($(this.parentNode)[0].parentNode.id);
            }

            IEBDOPettyInputChange();
            LiqPhpBDOPettyInputChange();
        });

        $(".cashBDLiqTable").on("change", ".txtLiqNoPCS", function (e) {
            var cashBDLiqItemNo = $(this.parentNode)[0].parentNode.id; //jquery obj

            var txtDenomination = $("#" + cashBDLiqItemNo).find('.txtLiqDenomination').val();
            var txtNoPCS = $("#" + cashBDLiqItemNo).find('.txtLiqNoPCS').val();

            $("#" + cashBDLiqItemNo).find('.txtLiqAmount').val(round(parseFloat(txtDenomination) * parseFloat(txtNoPCS), 2));

            var amountTotal = 0;
            var trs = $(".cashBDLiqTable").find("tbody").find("tr");

            for (var count = 0; count < trs.length - 1; count++) {
                var subTotal = parseFloat($("#" + trs[count].id).find('.txtLiqNoPCS').val()) * parseFloat($("#" + trs[count].id).find('.txtLiqDenomination').val());
                amountTotal = parseFloat(amountTotal) + parseFloat(subTotal);
            }

            $("#txtCashBDTotal").val(AC(round(amountTotal, 2)));
        });

        $('#IEInfoTable').on("change", "input.txtIEInfoInput", function (e) {
            $('#txtIEExRatePhp').val(AC(round($("#txtIEAmount").val() * $("#txtIEExRate").val(), 2)));
            $('#lblIEInput2').text($('#txtIEExRatePhp').val());
            $('#lblIEInput3').text($('#txtIEExRatePhp').val());
            $('#lblIEInput4').text(AC(round($("#txtIEAmount").val(), 2)));
            $('#lblIEInput5').text(AC(round($("#txtIEAmount").val(), 2)));
            $('#lblIEInput6').text(AC(round($("#txtIEAmount").val(), 2)));
            $('#lblIEInput7').text(AC(round($("#txtIEAmount").val(), 2)));
            $('#lblIEInput8').text(AC(round($("#txtIEAmount").val(), 2)));
            $('#lblIEInput9').text(AC(roundExceptionJPY($("#txtIEExRate").val(), 2)));
        });

        $('#IEInputTable').on("change", "#txtIEInput1", function (e) {
            $('#lblIEInput1').text(AC(round($("#txtIEInput1").val(), 2)));
        });

        $("table").on("click", "#saveLiqPhp", function (e) {

            e.stopImmediatePropagation();

            var selectedRow = $('#hiddenSelectedItem').val();

            var value1 = parseFloat($('#txtLiqPhpInput1').val()) + parseFloat($('#txtLiqPhpInput2').val());
            var value2 = parseFloat($('#txtLiqPhpInput3').val()) + parseFloat($('#txtLiqPhpInput4').val()) + parseFloat($('#txtLiqPhpInput5').val());

            if (value1 != value2) {
                $('#alert').text("The total amount of Debit and Credit did not match.");
                $('#divAlertWindow').show();
                return false;
            }
            var ddlPhp = $('#lblAccount1_PHP optgroup[label=' + getXMLLiqValue('ACCOUNT11_2') + '] option:first').val();
            if (ddlPhp == $('#ddlLiqPhpAccount2').val()) {

                if ($('#txtLiqPhpInput2').val() > 0) {
                    if ($('#txtCashBDTotal').val().replace(',', '') != $('#txtLiqPhpInput2').val()) {
                        $('#alert').text("The total Amount of cash breakdown and Petty cash amount do not match.");
                        $('#divAlertWindow').show();
                        return false;
                    }
                }

                if ($('#txtLiqPhpInput3').val() > 0) {
                    if ($('#txtCashBDTotal').val().replace(',', '') != $('#txtLiqPhpInput3').val()) {
                        $('#alert').text("The total Amount of cash breakdown and Petty cash amount do not match.");
                        $('#divAlertWindow').show();
                        return false;
                    }
                }

            }
            var ret = selectedRow.replace('item_', '');
            var trs = $('#cashBDLiqTable').find("tbody").find("tr");

            $('#divLiqCashBD_' + ret).empty();
            $('#divLiqIE_' + ret).empty();

            for (var count = 0; count < trs.length - 1; count++) {
                var denim = $("#" + trs[count].id).find('.txtLiqDenomination').val();
                var pcs = $("#" + trs[count].id).find('.txtLiqNoPCS').val();
                var amount = $("#" + trs[count].id).find('.txtLiqAmount').val();

                $('#divLiqCashBD_' + ret).append($('<input/>', {
                    id: 'LiquidationDetails_' + ret + '__liqCashBreakdown_' + count + '__cashDenomination',
                    type: 'hidden',
                    name: 'LiquidationDetails[' + ret + '].liqCashBreakdown[' + count + '].cashDenomination',
                    value: denim
                }));
                $('#divLiqCashBD_' + ret).append($('<input/>', {
                    id: 'LiquidationDetails_' + ret + '__liqCashBreakdown_' + count + '__cashNoPC',
                    type: 'hidden',
                    name: 'LiquidationDetails[' + ret + '].liqCashBreakdown[' + count + '].cashNoPC',
                    value: pcs
                }));
                $('#divLiqCashBD_' + ret).append($('<input/>', {
                    id: 'LiquidationDetails_' + ret + '__liqCashBreakdown_' + count + '__cashAmount',
                    type: 'hidden',
                    name: 'LiquidationDetails[' + ret + '].liqCashBreakdown[' + count + '].cashAmount',
                    value: amount
                }));
            }

            appendInputIEtoDiv(ret);
            setLiqPhpValuetoDivInput(ret)

            if (($('#txtLiqPhpInput6').val() != $('#txtLiqPhpInput7').val())) {
                $('#' + selectedRow).find(".hiddenLiqFlag").val(0);
            } else {
                $('#' + selectedRow).find(".hiddenLiqFlag").val(1);
                $('#' + selectedRow).find('#sss')
                    .animate({ backgroundColor: '#FFFBD5' }, 'slow')
                    .animate({ backgroundColor: 'transparent' }, 'slow');
                $('#' + selectedRow).find('#imgLiq').attr('src', '/images/liqLogo_chk.png');
            }
        });

        $("table").on("click", "#saveLiqIE", function (e) {

            e.stopImmediatePropagation();

            var selectedRow = $('#hiddenSelectedItem').val();

            //DISPLAY ERRORS
            if ($('#txtIEAmount').val().replace(',', '') != $('#' + selectedRow).find(".txtGross").val()) {
                $('#alert').text("Cash advance amount do not match.");
                $('#divAlertWindow').show();
                return false;
            }

            if ($('#txtIEExRate').val() == 0 || $('#txtIEExRate').val() == '' ) {
                $('#alert').text("Enter the Exchange Rate");
                $('#divAlertWindow').show();
                return false;
            }

            var value1 = parseFloat($('#txtIEInput2').val()) + parseFloat($('#txtIEInput3').val());
            var value2 = parseFloat($('#txtIEInput4').val()) + parseFloat($('#lblIEInput2').text().replace(',', ''));

            if (value1 != value2) {
                $('#alert').text("Inter-Entity(2nd Entry): Debit and Credit amount do not match.");
                $('#divAlertWindow').show();
                return false;
            }

            var ret = selectedRow.replace('item_', '');

            $('#divLiqIE_' + ret).empty();

            appendInputIEtoDiv(ret);
            setIEValuetoDivInput(ret);

            if ($('#txtIEAmount').val() == 0) {
                $('#' + selectedRow).find(".hiddenLiqFlag").val(0);
            } else {
                $('#' + selectedRow).find(".hiddenLiqFlag").val(2);
                $('#' + selectedRow).find('#sss')
                    .animate({ backgroundColor: '#FFFBD5' }, 'slow')
                    .animate({ backgroundColor: 'transparent' }, 'slow');
                $('#' + selectedRow).find('#imgLiq').attr('src', '/images/liqLogo_chk.png');
            }
        });

        //CDD Instruction sheet for Cash Advance(Suspense & Sundry) excel output cddISBtn
        $("table").on("click", ".cddISBtn", function (e) {
            e.stopImmediatePropagation();

            var pNode = $(this.parentNode)[0].parentNode;
            window.location.href = "/Home/CDD_IS_SS?entryID=" + $('.entryID').val()
                + "&entryDtlID=" + $('#' + pNode.id).find('.entryDtlID').val()
                + "&ccyAbbr=" + $('#' + pNode.id).find('.txtCcyAbbrev').val();
        });

        $('.tableLiqPhp').on('change', '.txtLiqPhpInput', function (e) {
            $(this).val(round($(this).val(), 2));
            $('#txtLiqPhpInput6').val(AC(parseFloat($('#txtLiqPhpInput1').val()) + parseFloat($('#txtLiqPhpInput2').val())));
            $('#txtLiqPhpInput7').val(AC(parseFloat($('#txtLiqPhpInput3').val()) + parseFloat($('#txtLiqPhpInput4').val()) + parseFloat($('#txtLiqPhpInput5').val())));

            ChangeOptionMarkForPrint();
        });
        $('.tableLiqPhp').on('change', '.ddlLiqPhpAccount', function (e) {
            assignAccCodeLiqPhp();
            HideCashBreakdownTable();
        });
        $('.tableLiqPhp').on('change', '#txtLiqVendor', function (e) {
            getVendorTaxRate($('#txtLiqVendor').val());
        });

        $("table").on("click", ".expenseEWT", function (e) {
                e.stopImmediatePropagation();
                var myModal2 = $('.myModal2');
                var modalDiv2 = $(myModal2).find('div div');
                var modalDivHeader2 = $(modalDiv2).find('.modal-header2');
                var modalDivBody2 = $(modalDiv2).find('.modal-body2');
                var modalDivFooter2 = $(modalDiv2).find('.modal-footer2');

                var pNode = $(this.parentNode)[0].parentNode;
                var taxpayor = $("#" + pNode.id).find(".txtPayor").val()

                //remove prev contents
                modalDivBody2.empty();
                modalDivHeader2.find('h4').remove();
                modalDivFooter2.find("#add_row_btn").remove();

                //set modal header title
                modalDivHeader2.append('<h4 class="modal-title">EWT Information</h4>');
                modalDivBody2.load("@Url.Action("EntryExpenseEWT", "Modal")", {
                    "id": pNode.id,
                    "taxpayor": taxpayor
                }, function (response, status, xhr) {
                    if (status == "error") {
                        alert("Something went wrong.");
                    }
                });

            $(myModal2).modal('show');
        });
    });
</script>
<script type="text/javascript" src="~/js/EntryScripts.js"></script>
<script type="text/javascript">
    $(function () {
        @*$(window).on("load", function () {
            if (@ViewBag.Success == 1) {
                alert("Entry Approved");
            } else if (@ViewBag.Success == 0){
                alert("Entry Failed");
            }
        });*@
        @if (int.Parse(HttpContextAccessor.HttpContext.Session.GetString("UserID")) == Model.maker
          || int.Parse(HttpContextAccessor.HttpContext.Session.GetString("UserID")) == Model.verifier_1_id
          || int.Parse(HttpContextAccessor.HttpContext.Session.GetString("UserID")) == Model.verifier_2_id
          || int.Parse(HttpContextAccessor.HttpContext.Session.GetString("UserID")) == Model.approver_id)
        {
            <Text>
            $("#entry-controls").on("click", "#printBir", function (e) {
                var vendorID = @Model.vendor;
                var approverID = @Model.approver_id;
                var link = [
                @foreach (var item in Model.birForms)
                {
                    <Text>
                         "/Home/Generate2307File?_vendor=@item.vendor&_ewt=@item.ewt&_tax=@item.vat&_amount=@item.amount&approver=@item.approver&expID=@Model.entryID",
                    </Text>
                }
                    ""
                ];

                for (var i = 0; i < link.length - 1; i++) {
                    window.open(link[i]);
                }
                $.getJSON('UpdateCDDPrintingStatus', { entryID: @Html.Raw(Json.Serialize(Model.entryID)) }, function (data) {

                });
                return false;
            });
            </Text>
        }

    });
</script>